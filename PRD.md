# 宠物收养系统产品需求文档 (PRD)

## 1. 产品概述和目标用户

### 1.1 产品概述

宠物收养系统是一个连接宠物发布者和收养者的在线平台，旨在为流浪宠物寻找温暖的家庭。平台提供宠物信息发布、浏览、搜索、沟通和收养申请等核心功能，简化宠物收养流程，提高收养成功率。

### 1.2 目标用户

#### 1.2.1 宠物发布者
- **用户画像**：拥有宠物需要送养的个人，或发现流浪宠物希望帮助其找到领养家庭的爱心人士
- **核心需求**：方便快捷地发布宠物信息，管理收养申请，与潜在收养者沟通
- **使用场景**：发布宠物信息、查看申请、审核申请、回复消息

#### 1.2.2 收养者
- **用户画像**：希望收养宠物的个人或家庭
- **核心需求**：浏览宠物信息、搜索筛选、联系发布者、提交收养申请
- **使用场景**：搜索宠物、查看详情、联系发布者、提交申请、查看申请状态

#### 1.2.3 系统管理员
- **用户画像**：负责平台运营和管理的工作人员
- **核心需求**：管理用户账号、审核内容、查看统计数据、处理违规行为
- **使用场景**：用户管理、内容审核、数据统计

## 2. 详细的功能列表

### 2.1 用户认证模块

#### 2.1.1 用户注册
- 支持邮箱注册
- 密码强度验证
- 邮箱验证（可选）
- 角色选择（发布者/收养者）

#### 2.1.2 用户登录
- 邮箱密码登录
- 记住登录状态
- 登录失败提示

#### 2.1.3 密码重置
- 通过邮箱重置密码
- 验证码验证

#### 2.1.4 用户信息管理
- 修改用户名
- 修改密码
- 绑定联系方式（电话、微信）
- 上传头像

### 2.2 宠物信息管理模块

#### 2.2.1 发布宠物信息
- 填写宠物基本信息
  - 品种（下拉选择/自定义输入）
  - 年龄（数字 + 单位）
  - 性别（单选：公/母/未知）
  - 健康状况（下拉选择）
  - 疫苗情况（下拉选择）
  - 绝育情况（下拉选择）
  - 发布地区（地区选择器）
- 上传宠物照片（支持多张，设置封面）
- 填写宠物描述（富文本编辑器）
- 设置宠物状态（默认：待收养）

#### 2.2.2 编辑宠物信息
- 修改所有可编辑字段
- 添加/删除照片
- 修改宠物状态

#### 2.2.3 删除宠物信息
- 删除确认提示
- 删除后不可恢复

#### 2.2.4 查看宠物列表
- 分页展示
- 卡片式布局
- 显示封面图、品种、年龄、地区、状态
- 支持排序（最新发布、最多浏览）

#### 2.2.5 查看宠物详情
- 完整信息展示
- 照片轮播
- 发布者信息展示
- 联系方式展示
- 收养申请入口

### 2.3 收养申请模块

#### 2.3.1 提交收养申请
- 选择宠物
- 填写申请备注
- 提交申请
- 申请成功提示

#### 2.3.2 查看申请列表（发布者）
- 按宠物分组展示
- 显示申请者信息
- 显示申请时间
- 显示申请状态
- 支持筛选（待审核、已同意、已拒绝）

#### 2.3.3 审核申请
- 查看申请详情
- 同意申请
  - 确认提示
  - 自动更新宠物状态为"已收养"
  - 拒绝其他待审核申请
- 拒绝申请
  - 填写拒绝原因（可选）
  - 发送通知给申请者

#### 2.3.4 查看申请状态（收养者）
- 查看所有申请
- 显示申请状态
- 显示申请时间
- 显示审核结果

### 2.4 沟通模块

#### 2.4.1 显示联系方式
- 在宠物详情页显示发布者联系方式
- 支持显示电话、微信
- 隐私设置（发布者可选择是否显示）

#### 2.4.2 站内消息系统
- 发送消息
  - 选择接收者
  - 关联宠物（可选）
  - 输入消息内容
  - 发送消息
- 接收消息
  - 消息列表
  - 未读消息标记
  - 消息通知
- 查看消息历史
  - 按联系人分组
  - 时间线展示
  - 消息搜索
- 标记消息已读

### 2.5 搜索筛选模块

#### 2.5.1 筛选功能
- 按品种筛选
- 按年龄筛选（区间选择）
- 按性别筛选
- 按地区筛选
- 按健康状况筛选
- 按宠物状态筛选
- 组合筛选

#### 2.5.2 搜索功能
- 关键词搜索
  - 搜索品种
  - 搜索描述
  - 搜索地区
- 搜索历史
- 热门搜索推荐

#### 2.5.3 排序功能
- 按发布时间排序
- 按浏览量排序
- 按申请数量排序

### 2.6 管理员模块

#### 2.6.1 用户管理
- 查看用户列表
  - 分页展示
  - 搜索用户
  - 筛选用户（按角色）
- 查看用户详情
  - 基本信息
  - 发布的宠物
  - 收养记录
- 封禁/解封用户
  - 封禁原因
  - 封禁期限
  - 解封操作

#### 2.6.2 内容管理
- 查看所有宠物信息
- 删除违规内容
  - 删除原因
  - 通知发布者
- 查看统计数据
  - 用户数量
  - 宠物数量
  - 收养成功数量
  - 活跃度统计

## 3. 功能优先级

### 3.1 MVP 版本（第一阶段）

#### 必须实现
- 用户注册/登录
- 发布宠物信息
- 查看宠物列表和详情
- 提交收养申请
- 审核收养申请
- 显示联系方式
- 基础搜索筛选

#### 可选实现
- 站内消息系统
- 用户信息管理

### 3.2 后续版本（第二阶段）

#### 功能增强
- 完善站内消息系统
- 用户信息管理
- 密码重置
- 高级筛选功能
- 消息通知

#### 管理功能
- 管理员后台
- 用户管理
- 内容审核
- 统计数据

### 3.3 扩展版本（第三阶段）

#### 体验优化
- 收藏宠物功能
- 收养记录/历史
- 评论/评价功能
- 宠物健康档案

#### 高级功能
- 宠物领养协议
- 志愿者系统
- 捐赠功能
- 宠物救助地图

## 4. 界面设计要求

### 4.1 设计原则
- 简洁明了，突出核心功能
- 响应式设计，支持移动端
- 色彩温馨，符合宠物主题
- 操作流程简单直观

### 4.2 页面布局

#### 4.2.1 首页
- 顶部导航栏（Logo、搜索、登录/注册、用户菜单）
- 轮播图（推荐宠物）
- 筛选栏（品种、地区、性别）
- 宠物列表（卡片式布局）
- 底部信息栏

#### 4.2.2 宠物详情页
- 宠物照片轮播
- 宠物基本信息
- 宠物描述
- 发布者信息
- 联系方式
- 收养申请按钮
- 相关推荐

#### 4.2.3 发布宠物页
- 分步表单
  - 第一步：基本信息
  - 第二步：照片上传
  - 第三步：描述
- 预览功能
- 提交按钮

#### 4.2.4 用户中心
- 侧边栏导航
  - 我的宠物
  - 我的申请
  - 消息中心
  - 个人信息
- 内容区域

#### 4.2.5 管理员后台
- 侧边栏导航
  - 用户管理
  - 宠物管理
  - 统计数据
- 内容区域

### 4.3 组件设计
- 按钮（主要、次要、危险）
- 表单输入框
- 下拉选择器
- 卡片组件
- 模态框
- 提示框
- 加载状态

### 4.4 交互设计
- 悬停效果
- 点击反馈
- 加载动画
- 错误提示
- 成功提示

## 5. 技术栈建议

### 5.1 前端技术栈
- **框架**：React 18+
- **构建工具**：Vite
- **UI 组件库**：shadcn/ui
- **样式方案**：Tailwind CSS v3.x
- **状态管理**：React Context / Zustand
- **路由**：React Router
- **表单处理**：React Hook Form
- **HTTP 客户端**：Axios / Fetch API
- **图片上传**：Supabase Storage

### 5.2 后端技术栈
- **框架**：Next.js 14+ (App Router)
- **API**：Next.js API Routes
- **认证**：Supabase Auth
- **数据库**：Supabase PostgreSQL
- **ORM**：Prisma（可选）
- **文件存储**：Supabase Storage
- **实时通信**：Supabase Realtime（可选）

### 5.3 开发工具
- **代码编辑器**：VS Code
- **版本控制**：Git
- **包管理器**：pnpm / npm
- **代码规范**：ESLint + Prettier
- **类型检查**：TypeScript

## 6. 非功能性需求

### 6.1 性能要求
- 页面加载时间 < 3 秒
- API 响应时间 < 500ms
- 支持并发用户数 > 1000
- 图片加载优化（懒加载、压缩）
- 代码分割和按需加载

### 6.2 安全要求
- 密码加密存储（bcrypt）
- SQL 注入防护
- XSS 攻击防护
- CSRF 攻击防护
- 文件上传安全验证
- 敏感信息脱敏显示
- HTTPS 加密传输
- JWT / Session 认证

### 6.3 可用性要求
- 系统可用性 > 99.5%
- 数据备份策略
- 错误监控和日志记录
- 优雅的错误处理

### 6.4 兼容性要求
- 支持主流浏览器（Chrome、Firefox、Safari、Edge）
- 支持移动端（iOS、Android）
- 响应式设计

### 6.5 可扩展性要求
- 模块化设计
- 易于添加新功能
- 数据库设计支持扩展
- API 设计支持版本控制

## 7. 代码风格和架构模式

### 7.1 代码风格

#### 7.1.1 命名规范
- **变量和函数**：camelCase（如：userName、getUserInfo）
- **常量**：UPPER_SNAKE_CASE（如：MAX_UPLOAD_SIZE）
- **类和组件**：PascalCase（如：UserProfile、PetCard）
- **文件名**：kebab-case（如：user-profile.tsx、pet-card.tsx）

#### 7.1.2 代码格式
- 使用 2 空格缩进
- 使用单引号
- 语句末尾加分号
- 每行最大长度 100 字符
- 函数之间空一行

#### 7.1.3 注释规范
- 关键逻辑添加中文注释
- 函数添加 JSDoc 注释
- 复杂算法添加详细说明
- 避免无意义的注释

### 7.2 架构模式

#### 7.2.1 前端架构
- **分层架构**
  - 展示层（UI 组件）
  - 业务逻辑层（Hooks、Services）
  - 数据层（API 调用）
- **组件化设计**
  - 原子组件（Button、Input）
  - 分子组件（Card、Form）
  - 组织组件（Page、Layout）
- **状态管理**
  - 本地状态：useState
  - 全局状态：Context / Zustand
  - 服务端状态：React Query（可选）

#### 7.2.2 后端架构
- **分层架构**
  - 路由层（API Routes）
  - 控制器层（Controllers）
  - 服务层（Services）
  - 数据访问层（Repository）
- **RESTful API 设计**
  - 统一的响应格式
  - 合理的 HTTP 方法
  - 清晰的资源命名
- **错误处理**
  - 统一的错误处理中间件
  - 友好的错误信息

#### 7.2.3 数据库设计
- **规范化设计**
  - 第三范式
  - 合理的表结构
  - 适当的索引
- **数据完整性**
  - 外键约束
  - 唯一约束
  - 检查约束

### 7.3 设计模式
- **单例模式**：数据库连接、配置管理
- **工厂模式**：组件创建
- **观察者模式**：事件监听、状态更新
- **策略模式**：不同的认证方式
- **适配器模式**：第三方 API 集成

## 8. 限制条件和边界场景

### 8.1 限制条件

#### 8.1.1 数据限制
- 单个用户最多发布 50 个宠物信息
- 单个宠物最多上传 10 张照片
- 单张照片最大 5MB
- 消息内容最大 1000 字符
- 宠物描述最大 5000 字符

#### 8.1.2 操作限制
- 同一宠物同一用户只能提交一次申请
- 已收养的宠物不能再申请
- 已下架的宠物不能申请
- 封禁用户不能发布和申请

#### 8.1.3 时间限制
- 申请审核时间限制（如 7 天内必须处理）
- 密码重置链接有效期（如 24 小时）
- 验证码有效期（如 5 分钟）

### 8.2 边界场景

#### 8.2.1 用户相关
- 用户未登录时的操作限制
- 用户被封禁后的处理
- 用户删除账号后的数据处理
- 用户同时登录多个设备

#### 8.2.2 宠物相关
- 宠物信息被删除后的申请处理
- 宠物状态变更时的通知
- 宠物照片上传失败的处理
- 宠物信息字段为空的处理

#### 8.2.3 申请相关
- 申请被拒绝后的处理
- 申请超时未审核的处理
- 发布者删除宠物后的申请处理
- 收养者取消申请的处理

#### 8.2.4 消息相关
- 消息发送失败的处理
- 消息接收者被封禁的处理
- 消息内容违规的处理
- 消息历史过长的处理

#### 8.2.5 系统相关
- 网络异常时的处理
- 服务器宕机时的处理
- 数据库连接失败的处理
- 文件存储空间不足的处理

### 8.3 异常处理
- 所有 API 调用添加错误处理
- 用户友好的错误提示
- 错误日志记录
- 关键操作添加重试机制

### 8.4 数据验证
- 前端表单验证
- 后端数据验证
- 文件类型和大小验证
- SQL 注入防护

### 8.5 合规性
- 用户隐私保护
- 数据安全合规
- 内容审核机制
- 违规内容处理流程
